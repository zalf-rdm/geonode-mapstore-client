"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[32494],{720825:(t,e,i)=>{i.d(e,{Z:()=>h});var s=i(394806),n=i(637195),r=i(968326),o=i(518096);class a extends s.Z{constructor(t,e,i,s,n,r){super(t,e,r),this.crossOrigin_=s,this.src_=i,this.key=i,this.image_=new Image,null!==s&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=n}getImage(){return this.image_}setImage(t){this.image_=t,this.state=n.Z.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=n.Z.ERROR,this.unlistenImage_(),this.image_=function(){const t=(0,r.E4)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=n.Z.LOADED:this.state=n.Z.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==n.Z.ERROR&&(this.state=n.Z.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==n.Z.IDLE&&(this.state=n.Z.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,o.K)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}const h=a},394806:(t,e,i)=>{i.d(e,{Z:()=>l});var s=i(100208),n=i(185487),r=i(637195),o=i(974187),a=i(531015);class h extends s.Z{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(n.Z.CHANGE)}release(){this.state===r.Z.ERROR&&this.setState(r.Z.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==r.Z.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){if(!this.interimTile)return;let t=this.interimTile,e=this;do{if(t.getState()==r.Z.LOADED){t.interimTile=null;break}t.getState()==r.Z.LOADING?e=t:t.getState()==r.Z.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==r.Z.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){(0,o.O3)()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const s=e-i+1e3/60;return s>=this.transition_?1:(0,a.YQ)(s/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}}const l=h},102519:(t,e,i)=>{i.d(e,{T:()=>n,Z:()=>r});class s{constructor(t,e,i,s){this.minX=t,this.maxX=e,this.minY=i,this.maxY=s}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function n(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new s(t,e,i,n)}const r=s},637195:(t,e,i)=>{i.d(e,{Z:()=>s});const s={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},594272:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(701295),n=i(808280);class r extends s.Z{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(n.Z.PRELOAD)}setPreload(t){this.set(n.Z.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(n.Z.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(n.Z.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}const o=r},619649:(t,e,i)=>{i.d(e,{Z:()=>m});var s=i(701295);class n extends s.Z{constructor(t){super(t=t||{})}}const r=n;var o=i(957581),a=i(570553),h=i(737755),l=i(506101),c=i(928641),d=i(31660);class u extends o.Z{constructor(t){super(t),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],i=t.pixelRatio,s=t.viewState,n=s.resolution,r=this.getLayer().getSource(),o=t.viewHints;let l=t.extent;if(void 0!==e.extent&&(l=(0,c.Ed)(l,(0,d.dY)(e.extent,s.projection))),!o[h.Z.ANIMATING]&&!o[h.Z.INTERACTING]&&!(0,c.xb)(l))if(r){const t=s.projection,e=r.getImage(l,n,i,t);e&&(this.loadImage(e)?this.image_=e:e.getState()===a.Z.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),s=(0,l.nn)(e.pixelToCoordinateTransform,t.slice()),n=i.getExtent();if(n&&!(0,c.b8)(n,s))return null;const r=this.image_.getExtent(),o=this.getImage(),a=(0,c.dz)(r),h=Math.floor(o.width*((s[0]-r[0])/a));if(h<0||h>=o.width)return null;const d=(0,c.Cr)(r),u=Math.floor(o.height*((r[3]-s[1])/d));return u<0||u>=o.height?null:this.getImageData(o,h,u)}renderFrame(t,e){const i=this.image_,s=i.getExtent(),n=i.getResolution(),r=i.getPixelRatio(),o=t.layerStatesArray[t.layerIndex],a=t.pixelRatio,h=t.viewState,u=h.center,g=a*n/(h.resolution*r),m=t.extent,_=h.resolution,T=h.rotation,x=Math.round((0,c.dz)(m)/_*a),f=Math.round((0,c.Cr)(m)/_*a);(0,l.qC)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/a,1/a,T,-x/2,-f/2),(0,l.nb)(this.inversePixelTransform,this.pixelTransform);const p=(0,l.BB)(this.pixelTransform);this.useContainer(e,p,this.getBackground(t));const E=this.context,I=E.canvas;I.width!=x||I.height!=f?(I.width=x,I.height=f):this.containerReused||E.clearRect(0,0,x,f);let R=!1,Z=!0;if(o.extent){const e=(0,d.dY)(o.extent,h.projection);Z=(0,c.kK)(e,t.extent),R=Z&&!(0,c.r4)(e,t.extent),R&&this.clipUnrotated(E,t,e)}const v=this.getImage(),S=(0,l.qC)(this.tempTransform,x/2,f/2,g,g,0,r*(s[0]-u[0])/n,r*(u[1]-s[3])/n);this.renderedResolution=n*a/r;const w=v.width*S[0],C=v.height*S[3];if(this.getLayer().getSource().getInterpolate()||(E.imageSmoothingEnabled=!1),this.preRender(E,t),Z&&w>=.5&&C>=.5){const t=S[4],e=S[5],i=o.opacity;let s;1!==i&&(s=E.globalAlpha,E.globalAlpha=i),E.drawImage(v,0,0,+v.width,+v.height,t,e,w,C),1!==i&&(E.globalAlpha=s)}return this.postRender(E,t),R&&E.restore(),E.imageSmoothingEnabled=!0,p!==I.style.transform&&(I.style.transform=p),this.container}}const g=u,m=class extends r{constructor(t){super(t)}createRenderer(){return new g(this)}getData(t){return super.getData(t)}}},341666:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(594272),n=i(708845);class r extends s.Z{constructor(t){super(t)}createRenderer(){return new n.Z(this)}}const o=r},808280:(t,e,i)=>{i.d(e,{Z:()=>s});const s={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"}},708845:(t,e,i)=>{i.d(e,{Z:()=>_});var s=i(957581),n=i(720825),r=i(809494),o=i(102519),a=i(637195),h=i(506101),l=i(465537),c=i(928641),d=i(31660),u=i(974187),g=i(904307);class m extends s.Z{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=(0,c.lJ)(),this.tmpTileRange_=new o.Z(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),s=e.getUseInterimTilesOnError();return i==a.Z.LOADED||i==a.Z.EMPTY||i==a.Z.ERROR&&!s}getTile(t,e,i,s){const n=s.pixelRatio,r=s.viewState.projection,o=this.getLayer();let h=o.getSource().getTile(t,e,i,n,r);return h.getState()==a.Z.ERROR&&o.getUseInterimTilesOnError()&&o.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(h)||(h=h.getInterimTile()),h}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),s=(0,h.nn)(e.pixelToCoordinateTransform,t.slice()),o=i.getExtent();if(o&&!(0,c.b8)(o,s))return null;const l=e.pixelRatio,d=e.viewState.projection,u=e.viewState,m=i.getRenderSource(),_=m.getTileGridForProjection(u.projection),T=m.getTilePixelRatio(e.pixelRatio);for(let t=_.getZForResolution(u.resolution);t>=_.getMinZoom();--t){const e=_.getTileCoordForCoordAndZ(s,t),i=m.getTile(t,e[1],e[2],l,d);if(!(i instanceof n.Z||i instanceof r.Z)||i instanceof r.Z&&i.getState()===a.Z.EMPTY)return null;if(i.getState()!==a.Z.LOADED)continue;const o=_.getOrigin(t),h=(0,g.Pq)(_.getTileSize(t)),c=_.getResolution(t),x=Math.floor(T*((s[0]-o[0])/c-e[1]*h[0])),f=Math.floor(T*((o[1]-s[1])/c-e[2]*h[1])),p=Math.round(T*m.getGutterForProjection(u.projection));return this.getImageData(i.getImage(),x+p,f+p)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],s=t.viewState,n=s.projection,r=s.resolution,o=s.center,g=s.rotation,m=t.pixelRatio,_=this.getLayer(),T=_.getSource(),x=T.getRevision(),f=T.getTileGridForProjection(n),p=f.getZForResolution(r,T.zDirection),E=f.getResolution(p);let I=t.extent;const R=t.viewState.resolution,Z=T.getTilePixelRatio(m),v=Math.round((0,c.dz)(I)/R*m),S=Math.round((0,c.Cr)(I)/R*m),w=i.extent&&(0,d.dY)(i.extent,n);w&&(I=(0,c.Ed)(I,(0,d.dY)(i.extent,n)));const C=E*v/2/Z,P=E*S/2/Z,Y=[o[0]-C,o[1]-P,o[0]+C,o[1]+P],b=f.getTileRangeForExtentAndZ(I,p),O={};O[p]={};const y=this.createLoadedTileFinder(T,n,O),D=this.tmpExtent,L=this.tmpTileRange_;this.newTiles_=!1;const M=g?(0,c.dY)(s.center,R,g,t.size):void 0;for(let e=b.minX;e<=b.maxX;++e)for(let s=b.minY;s<=b.maxY;++s){if(g&&!f.tileCoordIntersectsViewport([p,e,s],M))continue;const n=this.getTile(p,e,s,t);if(this.isDrawableTile(n)){const e=(0,u.sq)(this);if(n.getState()==a.Z.LOADED){O[p][n.tileCoord.toString()]=n;let t=n.inTransition(e);t&&1!==i.opacity&&(n.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(n)||(this.newTiles_=!0)}if(1===n.getAlpha(e,t.time))continue}const r=f.getTileCoordChildTileRange(n.tileCoord,L,D);let o=!1;r&&(o=y(p+1,r)),o||f.forEachTileCoordParentTileRange(n.tileCoord,y,L,D)}const X=E/r*m/Z;(0,h.qC)(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/m,1/m,g,-v/2,-S/2);const W=(0,h.BB)(this.pixelTransform);this.useContainer(e,W,this.getBackground(t));const F=this.context,A=F.canvas;(0,h.nb)(this.inversePixelTransform,this.pixelTransform),(0,h.qC)(this.tempTransform,v/2,S/2,X,X,0,-v/2,-S/2),A.width!=v||A.height!=S?(A.width=v,A.height=S):this.containerReused||F.clearRect(0,0,v,S),w&&this.clipUnrotated(F,t,w),T.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,t),this.renderedTiles.length=0;let j,G,z,k=Object.keys(O).map(Number);k.sort(l.j2),1!==i.opacity||this.containerReused&&!T.getOpaque(t.viewState.projection)?(j=[],G=[]):k=k.reverse();for(let e=k.length-1;e>=0;--e){const i=k[e],s=T.getTilePixelSize(i,m,n),r=f.getResolution(i)/E,o=s[0]*r*X,a=s[1]*r*X,l=f.getTileCoordForCoordAndZ((0,c.rL)(Y),i),d=f.getTileCoordExtent(l),g=(0,h.nn)(this.tempTransform,[Z*(d[0]-Y[0])/E,Z*(Y[3]-d[3])/E]),_=Z*T.getGutterForProjection(n),x=O[i];for(const e in x){const s=x[e],n=s.tileCoord,r=l[1]-n[1],h=Math.round(g[0]-(r-1)*o),d=l[2]-n[2],m=Math.round(g[1]-(d-1)*a),f=Math.round(g[0]-r*o),E=Math.round(g[1]-d*a),I=h-f,R=m-E,Z=p===i,v=Z&&1!==s.getAlpha((0,u.sq)(this),t.time);let S=!1;if(!v)if(j){z=[f,E,f+I,E,f+I,E+R,f,E+R];for(let t=0,e=j.length;t<e;++t)if(p!==i&&i<G[t]){const e=j[t];(0,c.kK)([f,E,f+I,E+R],[e[0],e[3],e[4],e[7]])&&(S||(F.save(),S=!0),F.beginPath(),F.moveTo(z[0],z[1]),F.lineTo(z[2],z[3]),F.lineTo(z[4],z[5]),F.lineTo(z[6],z[7]),F.moveTo(e[6],e[7]),F.lineTo(e[4],e[5]),F.lineTo(e[2],e[3]),F.lineTo(e[0],e[1]),F.clip())}j.push(z),G.push(i)}else F.clearRect(f,E,I,R);this.drawTileImage(s,t,f,E,I,R,_,Z),j&&!v?(S&&F.restore(),this.renderedTiles.unshift(s)):this.renderedTiles.push(s),this.updateUsedTiles(t.usedTiles,T,s)}}return this.renderedRevision=x,this.renderedResolution=E,this.extentChanged=!this.renderedExtent_||!(0,c.fS)(this.renderedExtent_,Y),this.renderedExtent_=Y,this.renderedPixelRatio=m,this.renderedProjection=n,this.manageTilePyramid(t,T,f,m,n,I,p,_.getPreload()),this.scheduleExpireCache(t,T),this.postRender(F,t),i.extent&&F.restore(),F.imageSmoothingEnabled=!0,W!==A.style.transform&&(A.style.transform=W),this.container}drawTileImage(t,e,i,s,n,r,o,a){const h=this.getTileImage(t);if(!h)return;const l=(0,u.sq)(this),c=e.layerStatesArray[e.layerIndex],d=c.opacity*(a?t.getAlpha(l,e.time):1),g=d!==this.context.globalAlpha;g&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(h,o,o,h.width-2*o,h.height-2*o,i,s,n,r),g&&this.context.restore(),d!==c.opacity?e.animate=!0:a&&t.endTransition(l)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(t,e,i){const s=(0,u.sq)(t);s in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[s])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const s=(0,u.sq)(e);s in t||(t[s]={}),t[s][i.getKey()]=!0}manageTilePyramid(t,e,i,s,n,r,o,h,l){const d=(0,u.sq)(e);d in t.wantedTiles||(t.wantedTiles[d]={});const g=t.wantedTiles[d],m=t.tileQueue,_=i.getMinZoom(),T=t.viewState.rotation,x=T?(0,c.dY)(t.viewState.center,t.viewState.resolution,T,t.size):void 0;let f,p,E,I,R,Z,v=0;for(Z=_;Z<=o;++Z)for(p=i.getTileRangeForExtentAndZ(r,Z,p),E=i.getResolution(Z),I=p.minX;I<=p.maxX;++I)for(R=p.minY;R<=p.maxY;++R)T&&!i.tileCoordIntersectsViewport([Z,I,R],x)||(o-Z<=h?(++v,f=e.getTile(Z,I,R,s,n),f.getState()==a.Z.IDLE&&(g[f.getKey()]=!0,m.isKeyQueued(f.getKey())||m.enqueue([f,d,i.getTileCoordCenter(f.tileCoord),E])),void 0!==l&&l(f)):e.useTile(Z,I,R,n));e.updateCacheSize(v,n)}}const _=m},887161:(t,e,i)=>{i.d(e,{rX:()=>h,aA:()=>d,Co:()=>u,sY:()=>g});var s=i(928641),n=i(968326),r=i(31660),o=i(733983);let a;const h=[];function l(t,e,i,s,n){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(s,n),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,s)+1,Math.max(i,n)),t.restore()}function c(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function d(t,e,i,n){const o=(0,r.vs)(i,e,t);let a=(0,r._Q)(e,n,i);const h=e.getMetersPerUnit();void 0!==h&&(a*=h);const l=t.getMetersPerUnit();void 0!==l&&(a/=l);const c=t.getExtent();if(!c||(0,s.b8)(c,o)){const e=(0,r._Q)(t,a,o)/a;isFinite(e)&&e>0&&(a/=e)}return a}function u(t,e,i,n){const r=(0,s.qg)(i);let o=d(t,e,r,n);return(!isFinite(o)||o<=0)&&(0,s.H6)(i,(function(i){return o=d(t,e,i,n),isFinite(o)&&o>0})),o}function g(t,e,i,r,d,u,g,m,_,T,x,f){const p=(0,n.E4)(Math.round(i*t),Math.round(i*e),h);if(f||(p.imageSmoothingEnabled=!1),0===_.length)return p.canvas;function E(t){return Math.round(t*i)/i}p.scale(i,i),p.globalCompositeOperation="lighter";const I=(0,s.lJ)();_.forEach((function(t,e,i){(0,s.l7)(I,t.extent)}));const R=(0,s.dz)(I),Z=(0,s.Cr)(I),v=(0,n.E4)(Math.round(i*R/r),Math.round(i*Z/r),h);f||(v.imageSmoothingEnabled=!1);const S=i/r;_.forEach((function(t,e,i){const n=t.extent[0]-I[0],r=-(t.extent[3]-I[3]),o=(0,s.dz)(t.extent),a=(0,s.Cr)(t.extent);t.image.width>0&&t.image.height>0&&v.drawImage(t.image,T,T,t.image.width-2*T,t.image.height-2*T,n*S,r*S,o*S,a*S)}));const w=(0,s.rL)(g);return m.getTriangles().forEach((function(t,e,s){const d=t.source,g=t.target;let m=d[0][0],_=d[0][1],T=d[1][0],x=d[1][1],R=d[2][0],Z=d[2][1];const S=E((g[0][0]-w[0])/u),C=E(-(g[0][1]-w[1])/u),P=E((g[1][0]-w[0])/u),Y=E(-(g[1][1]-w[1])/u),b=E((g[2][0]-w[0])/u),O=E(-(g[2][1]-w[1])/u),y=m,D=_;m=0,_=0,T-=y,x-=D,R-=y,Z-=D;const L=[[T,x,0,0,P-S],[R,Z,0,0,b-S],[0,0,T,x,Y-C],[0,0,R,Z,O-C]],M=(0,o.SV)(L);if(M){if(p.save(),p.beginPath(),function(){if(void 0===a){const t=(0,n.E4)(6,6,h);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",l(t,4,5,4,0),l(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;a=c(e,0)||c(e,4)||c(e,8),(0,n.jy)(t),h.push(t.canvas)}return a}()||!f){p.moveTo(P,Y);const t=4,e=S-P,i=C-Y;for(let s=0;s<t;s++)p.lineTo(P+E((s+1)*e/t),Y+E(s*i/(t-1))),s!=t-1&&p.lineTo(P+E((s+1)*e/t),Y+E((s+1)*i/(t-1)));p.lineTo(b,O)}else p.moveTo(P,Y),p.lineTo(S,C),p.lineTo(b,O);p.clip(),p.transform(M[0],M[2],M[1],M[3],S,C),p.translate(I[0]-y,I[3]-D),p.scale(r/i,-r/i),p.drawImage(v.canvas,0,0),p.restore()}})),(0,n.jy)(v),h.push(v.canvas),x&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,m.getTriangles().forEach((function(t,e,i){const s=t.target,n=(s[0][0]-w[0])/u,r=-(s[0][1]-w[1])/u,o=(s[1][0]-w[0])/u,a=-(s[1][1]-w[1])/u,h=(s[2][0]-w[0])/u,l=-(s[2][1]-w[1])/u;p.beginPath(),p.moveTo(o,a),p.lineTo(n,r),p.lineTo(h,l),p.closePath(),p.stroke()})),p.restore()),p.canvas}},809494:(t,e,i)=>{i.d(e,{Z:()=>m});var s=i(504773),n=i(185487),r=i(394806),o=i(637195),a=i(55476),h=i(887161),l=i(733983),c=i(928641),d=i(465818),u=i(968326);class g extends r.Z{constructor(t,e,i,n,r,d,u,g,m,_,T,x){super(r,o.Z.IDLE,{interpolate:!!x}),this.renderEdges_=void 0!==T&&T,this.pixelRatio_=u,this.gutter_=g,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=d||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const f=n.getTileCoordExtent(this.wrappedTileCoord_),p=this.targetTileGrid_.getExtent();let E=this.sourceTileGrid_.getExtent();const I=p?(0,c.Ed)(f,p):f;if(0===(0,c.bg)(I))return void(this.state=o.Z.EMPTY);const R=t.getExtent();R&&(E=E?(0,c.Ed)(E,R):R);const Z=n.getResolution(this.wrappedTileCoord_[0]),v=(0,h.Co)(t,i,I,Z);if(!isFinite(v)||v<=0)return void(this.state=o.Z.EMPTY);const S=void 0!==_?_:s.m;if(this.triangulation_=new a.Z(t,i,I,E,v*S,Z),0===this.triangulation_.getTriangles().length)return void(this.state=o.Z.EMPTY);this.sourceZ_=e.getZForResolution(v);let w=this.triangulation_.calculateSourceExtent();if(E&&(t.canWrapX()?(w[1]=(0,l.uZ)(w[1],E[1],E[3]),w[3]=(0,l.uZ)(w[3],E[1],E[3])):w=(0,c.Ed)(w,E)),(0,c.bg)(w)){const t=e.getTileRangeForExtentAndZ(w,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=m(this.sourceZ_,e,i,u);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=o.Z.EMPTY)}else this.state=o.Z.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&e.getState()==o.Z.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=o.Z.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],n="number"==typeof i?i:i[1],r=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,h.sY)(s,n,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),r,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=o.Z.LOADED}this.changed()}load(){if(this.state==o.Z.IDLE){this.state=o.Z.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(i==o.Z.IDLE||i==o.Z.LOADING){t++;const i=(0,d.oL)(e,n.Z.CHANGE,(function(s){const n=e.getState();n!=o.Z.LOADED&&n!=o.Z.ERROR&&n!=o.Z.EMPTY||((0,d.bN)(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){t.getState()==o.Z.IDLE&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(d.bN),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,u.jy)(this.canvas_.getContext("2d")),h.rX.push(this.canvas_),this.canvas_=null),super.release()}}const m=g},55476:(t,e,i)=>{i.d(e,{Z:()=>o});var s=i(928641),n=i(31660),r=i(733983);const o=class{constructor(t,e,i,r,o,a){this.sourceProj_=t,this.targetProj_=e;let h={};const l=(0,n.Ck)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return h[e]||(h[e]=l(t)),h[e]},this.maxSourceExtent_=r,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&(0,s.dz)(r)>=(0,s.dz)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,s.dz)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,s.dz)(this.targetProj_.getExtent()):null;const c=(0,s.rL)(i),d=(0,s.Xv)(i),u=(0,s.w$)(i),g=(0,s.hC)(i),m=this.transformInv_(c),_=this.transformInv_(d),T=this.transformInv_(u),x=this.transformInv_(g),f=10+(a?Math.max(0,Math.ceil(Math.log2((0,s.bg)(i)/(a*a*256*256)))):0);if(this.addQuad_(c,d,u,g,m,_,T,x,f),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,s){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const s=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-s<this.sourceWorldWidth_/2&&(e.source=i)}}))}h={}}addTriangle_(t,e,i,s,n,r){this.triangles_.push({source:[s,n,r],target:[t,e,i]})}addQuad_(t,e,i,n,o,a,h,l,c){const d=(0,s.hI)([o,a,h,l]),u=this.sourceWorldWidth_?(0,s.dz)(d)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,m=this.sourceProj_.canWrapX()&&u>.5&&u<1;let _=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const r=(0,s.hI)([t,e,i,n]);_=(0,s.dz)(r)/this.targetWorldWidth_>.25||_}!m&&this.sourceProj_.isGlobal()&&u&&(_=u>.25||_)}if(!_&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!(0,s.kK)(d,this.maxSourceExtent_))return;let T=0;if(!(_||isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(h[0])&&isFinite(h[1])&&isFinite(l[0])&&isFinite(l[1])))if(c>0)_=!0;else if(T=(isFinite(o[0])&&isFinite(o[1])?0:8)+(isFinite(a[0])&&isFinite(a[1])?0:4)+(isFinite(h[0])&&isFinite(h[1])?0:2)+(isFinite(l[0])&&isFinite(l[1])?0:1),1!=T&&2!=T&&4!=T&&8!=T)return;if(c>0){if(!_){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],s=this.transformInv_(e);let n;n=m?((0,r.$W)(o[0],g)+(0,r.$W)(h[0],g))/2-(0,r.$W)(s[0],g):(o[0]+h[0])/2-s[0];const a=(o[1]+h[1])/2-s[1];_=n*n+a*a>this.errorThresholdSquared_}if(_){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const s=[(e[0]+i[0])/2,(e[1]+i[1])/2],r=this.transformInv_(s),d=[(n[0]+t[0])/2,(n[1]+t[1])/2],u=this.transformInv_(d);this.addQuad_(t,e,s,d,o,a,r,u,c-1),this.addQuad_(d,s,i,n,u,r,h,l,c-1)}else{const s=[(t[0]+e[0])/2,(t[1]+e[1])/2],r=this.transformInv_(s),d=[(i[0]+n[0])/2,(i[1]+n[1])/2],u=this.transformInv_(d);this.addQuad_(t,s,d,n,o,r,u,l,c-1),this.addQuad_(s,e,i,d,r,a,h,u,c-1)}return}}if(m){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&T||this.addTriangle_(t,i,n,o,h,l),14&T||this.addTriangle_(t,i,e,o,h,a),T&&(13&T||this.addTriangle_(e,n,t,a,l,o),7&T||this.addTriangle_(e,n,i,a,l,h))}calculateSourceExtent(){const t=(0,s.lJ)();return this.triangles_.forEach((function(e,i,n){const r=e.source;(0,s.Wj)(t,r[0]),(0,s.Wj)(t,r[1]),(0,s.Wj)(t,r[2])})),t}getTriangles(){return this.triangles_}}},504773:(t,e,i)=>{i.d(e,{m:()=>s});const s=.5}}]);