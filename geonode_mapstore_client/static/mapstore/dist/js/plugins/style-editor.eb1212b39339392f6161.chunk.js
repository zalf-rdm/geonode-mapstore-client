(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[91701],{501157:(e,t,r)=>{"use strict";r.d(t,{en:()=>M,FU:()=>_,gs:()=>G,tt:()=>W,jY:()=>$,QQ:()=>k,B8:()=>I,T6:()=>U,ZP:()=>F});var n=r(472500),i=r.n(n),o=r(701469),a=r.n(o),u=r(984596),l=r.n(u),s=r(227361),c=r.n(s),p=r(441609),f=r.n(p),y=r(264721),d=r.n(y),m=r(944908),g=r.n(m),b=r(727418),v=r.n(b),h=r(505055),S=r.n(h),O=r(375875),w=r.n(O),L=r(737275),x=r(986267),j=r(396606);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){B(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function B(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==P(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===P(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var C={},M=function(e){var t=(a()(e)&&e||e.split(","))[0],r=i().parse(t,!0);return i().format(v()({},r,{search:null},{query:v()({service:"WMS",version:"1.3.0",request:"GetCapabilities"},r.query)}))},T=function(e){var t=e&&e.Title,r=e.LogoURL&&E(E({},c()(e,"LogoURL.$")||{}),{},{format:c()(e,"LogoURL.Format")}),n=c()(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:r,imageUrl:c()(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:n}},D=function e(t){return t.Layer?(a()(t.Layer)&&t.Layer||[t.Layer]).reduce((function(t,r){return t.concat(e(r)).concat(r.Layer&&r.Name?[r]:[])}),[]):t.Name&&[t]||[]},q=function(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,u=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,s=(i.WMS_Capabilities||i.WMT_MS_Capabilities||{}).Capability,c=(i.WMS_Capabilities||i.WMT_MS_Capabilities||{}).Service,p=(n=s).Request&&n.Request.GetMap&&n.Request.GetMap.DCPType&&n.Request.GetMap.DCPType.HTTP&&n.Request.GetMap.DCPType.HTTP.Get&&n.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&n.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0,f=s.Layer&&(null===(e=s.Layer.SRS||s.Layer.CRS)||void 0===e?void 0:e.map((function(e){return e.toUpperCase()})))||[],y=s.Layer&&s.Layer.Attribution&&T(s.Layer.Attribution),d=s.Request&&s.Request.GetMap&&s.Request.GetMap.Format||[],m=D(s),g=(a()(m)?m:[m]).filter((function(e){return!l||-1!==e.Name.toLowerCase().indexOf(l.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(l.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(l.toLowerCase())}));return{numberOfRecordsMatched:g.length,numberOfRecordsReturned:Math.min(u,g.length),nextRecord:o+Math.min(u,g.length)+1,service:c,layerOptions:{version:(null===(t=i.WMS_Capabilities||i.WMT_MS_Capabilities)||void 0===t||null===(r=t.$)||void 0===r?void 0:r.version)||"1.3.0"},records:g.filter((function(e,t){return t>=o-1&&t<o-1+u})).map((function(e){return v()({},e,{formats:d,onlineResource:p,SRS:f,credits:e.Attribution?T(e.Attribution):y})}))}},_=function(e,t){var n=i().parse(e,!0),o=i().format(v()({},n,{query:v()({service:"WMS",version:"1.1.1",request:"GetCapabilities"},n.query)}));return new Promise((function(e){Promise.all([r.e(99942),r.e(67260)]).then(function(){var n=r(967260).unmarshaller;e(w().get(M(o)).then((function(e){var r;if(t)return S().parseString(e.data,{explicitArray:!1},(function(e,t){r=t})),r;var i=n.unmarshalString(e.data);return i&&i.value})))}.bind(null,r)).catch(r.oe)}))},A=function(e,t,r,n){var i=C[e];return i&&(new Date).getTime()<i.timestamp+1e3*((0,L.u8)("cacheExpire")||60)?new Promise((function(e){e(q(i.data,t,r,n))})):w().get(M(e)).then((function(i){var o;return S().parseString(i.data,{explicitArray:!1},(function(e,t){o=t})),C[e]={timestamp:(new Date).getTime(),data:o},q(o,t,r,n)}))},G=function(e,t){var r=i().parse(e,!0),n=i().format(v()({},r,{query:v()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},r.query)}));return w().get(M(n)).then((function(e){var t;return S().parseString(e.data,{explicitArray:!1},(function(e,r){t=r&&r.WMS_DescribeLayerResponse&&r.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return E(E({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:E({},e&&e.query&&e.query.$||{})})}))}))},W=function(e,t,r,n){return A(e,t,r,n)},$=function(e,t){for(var r=e,n=r.EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,x.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;!n&&r.Layer&&r.Layer.length;)n=(r=r.Layer[0]).EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,x.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;n||(n={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var i={extent:[n.westBoundLongitude||n.minx,n.southBoundLatitude||n.miny,n.eastBoundLongitude||n.maxx,n.northBoundLatitude||n.maxy],crs:"EPSG:4326"};return t?{crs:i.crs,bounds:{minx:i.extent[0],miny:i.extent[1],maxx:i.extent[2],maxy:i.extent[3]}}:i},k=[{label:"image/png",value:"image/png"},{label:"image/png8",value:"image/png8"},{label:"image/jpeg",value:"image/jpeg"},{label:"image/vnd.jpeg-png",value:"image/vnd.jpeg-png"},{label:"image/vnd.jpeg-png8",value:"image/vnd.jpeg-png8"},{label:"image/gif",value:"image/gif"}],I=function(){return g()(Object.values((0,j.eq)()))},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _(e).then((function(e){var r,n,i=c()(e,"capability.request.getMap.format",[]);if(f()(i))r=k;else{var o=k.map((function(e){return e.value}));r=(i=i.map((function(e){var t=e.value;return{label:t,value:t}}))).filter((function(e){var t=e.value;return d()(o,t)}))||[]}if(t){var a=c()(e,"capability.request.getFeatureInfo.format",[]),u=I();f()(a)?n=u:(a=a.map((function(e){return e.value})),n=g()(a.filter((function(e){return d()(u,e)})))||[])}return t?{imageFormats:r,infoFormats:n}:r})).catch((function(){return t?{imageFormats:k,infoFormats:I()}:k}))};const F={flatLayers:D,parseUrl:M,getDimensions:function(e){return l()(e.Dimension||e.dimension||[]).map((function(t,r){var n=e.Extent&&l()(e.Extent)[r]||e.extent&&l()(e.extent)[r];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||n&&n.$.default,values:t._&&t.split(",")||n&&n._&&n.split(",")}}))},getCapabilities:_,describeLayer:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i().parse(e,!0),a=i().format(v()({},o,{query:v()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},o.query,n.query||{})}));return new Promise((function(e){Promise.all([r.e(99942),r.e(67260)]).then(function(){var t=r(967260).unmarshaller;e(w().get(M(a)).then((function(e){var r=t.unmarshalString(e.data);return r&&r.value&&r.value.layerDescription&&r.value.layerDescription[0]})))}.bind(null,r)).catch(r.oe)}))},getRecords:A,describeLayers:G,textSearch:W,parseLayerCapabilities:function e(t,r,n){return l()(n||c()(t,"capability.layer.layer")).reduce((function(n,i){return n||(!i.name&&i.layer?e(t,r,l()(i.layer)):2===r.name.split(":").length&&i.name&&2===i.name.split(":").length?r.name===i.name&&i:i.name&&2===i.name.split(":").length?r.name===i.name.split(":")[1]&&i:2===r.name.split(":").length?r.name.split(":")[1]===i.name&&i:r.name===i.name&&i)}),null)},getBBox:$,reset:function(){Object.keys(C).forEach((function(e){delete C[e]}))},getUniqueInfoFormats:I,getSupportedFormat:U}},398592:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>G});var n=r(701469),i=r.n(n),o=r(747037),a=r.n(o),u=r(727418),l=r.n(u),s=r(675263),c=r.n(s),p=r(124852),f=r.n(p),y=r(171703),d=r(867076),m=r(22222),g=r(580416),b=r(396909),v=r(615402),h=r(965539),S=r(982030),O=r(173014),w=r(532425),L=r(274621),x=r(893222),j=r(99009),P=r(278720);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q(n.key),n)}}function M(e,t){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M(e,t)}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function D(e,t,r){return(t=q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e){var t=function(e,t){if("object"!==R(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===R(t)?t:String(t)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(l,e);var t,r,n,o,u=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=T(n);if(o){var r=T(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),u.apply(this,arguments)}return t=l,(r=[{key:"UNSAFE_componentWillMount",value:function(){var e=!this.props.editingAllowedRoles||i()(this.props.editingAllowedRoles)&&a()(this.props.userRole)&&-1!==this.props.editingAllowedRoles.indexOf(this.props.userRole);this.props.onInit(this.props.styleService,e&&(0,j.uW)(this.props.layer,this.props.styleService))}},{key:"render",value:function(){return f().createElement(h.Z,{className:"ms-style-editor-container",header:this.props.showToolbar?f().createElement("div",{className:"ms-style-editor-container-header"},this.props.header,f().createElement("div",{className:"text-center"},f().createElement(P.lC,{enableSetDefaultStyle:this.props.enableSetDefaultStyle}))):null,footer:f().createElement("div",{style:{height:25}})},this.props.isEditing?f().createElement(P.m2,{config:this.props.editorConfig}):f().createElement(P.tM,{showDefaultStyleIcon:this.props.canEdit&&this.props.enableSetDefaultStyle}))}}])&&C(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(f().Component);D(_,"propTypes",{layer:c().object,header:c().node,isEditing:c().bool,showToolbar:c().node.bool,onInit:c().func,styleService:c().object,userRole:c().string,editingAllowedRoles:c().array,enableSetDefaultStyle:c().bool,canEdit:c().bool,editorConfig:c().object}),D(_,"defaultProps",{layer:{},onInit:function(){},editingAllowedRoles:["ADMIN"],editorConfig:{}});var A=(0,d.compose)(d.toClass,(0,d.branch)((function(){return!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).active}),(function(){return function(){return null}})),(0,y.connect)((0,m.P1)([x.ex,x.aN,x.Vf,x.p,L.L3,x.z_,x.Z0],(function(e,t,r,n,i,o,a){return{isEditing:"edit"===e,loading:t,layer:r,error:n,userRole:i,canEdit:o,styleService:a}})),{onInit:b.E0,onUpdateParams:g.Xy},(function(e,t,r){var n,i,o,a=(null===(n=r.styleService)||void 0===n?void 0:n.baseUrl)===(null===(i=e.styleService)||void 0===i?void 0:i.baseUrl)&&(null===(o=e.styleService)||void 0===o?void 0:o.isStatic),u=r.styleService&&!a?B(B({},r.styleService),{},{isStatic:!0}):B({},e.styleService);return B(B(B(B({},r),e),t),{},{styleService:u})})),(0,S.Z)((function(e){var t=e.error;return!!(null!=t&&t.availableStyles||null!=t&&t.global||null!=t&&t.parsingCapabilities)}),(function(e){var t=e.error;return{glyph:"exclamation-mark",title:f().createElement(v.Z,{msgId:"styleeditor.errorTitle"}),description:f().createElement(v.Z,{msgId:((null==t?void 0:t.availableStyles)?"styleeditor.missingAvailableStylesMessage":(null==t?void 0:t.parsingCapabilities)&&"styleeditor.parsingCapabilitiesError")||(null==t?void 0:t.global)&&"styleeditor.globalError"}),style:{display:"flex",width:"100%",height:"100%",overflow:"hidden"},mainViewStyle:{margin:"auto",width:300}}})),(0,O.Z)((function(e){return"global"===e.loading}),{size:150,style:{margin:"auto"}},(function(e){return f().createElement("div",{style:{position:"relative",height:"100%",display:"flex"}},f().createElement(w.Z,e))})),(0,d.compose)((0,y.connect)((function(){return{}}),{toggleStyleEditor:b.Wv}),(0,d.lifecycle)({componentDidMount:function(){this.props.toggleStyleEditor(null,!0)}})))(_);const G={StyleEditorPlugin:l()(A,{TOC:{priority:1,container:"TOCItemSettings"},TOCItemsSettings:{name:"StyleEditor",target:"style",priority:1,ToolbarComponent:P.lC}}),reducers:{styleeditor:r(532244).Z},epics:r(394943).ZP}},274621:(e,t,r)=>{"use strict";r.d(t,{np:()=>n,L3:()=>i,jl:()=>o,y8:()=>a,qg:()=>u}),r(727418),r(227361);var n=function(e){return e&&e.security&&e.security.user},i=function(e){return n(e)&&n(e).role},o=function(e){return e&&e.security&&e.security.user},a=function(e){return e.security&&e.security.token},u=function(e){return"ADMIN"===i(e)}}}]);